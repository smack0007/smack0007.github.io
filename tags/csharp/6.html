<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1"><meta name=description content=""><meta name=author content="Zachary Snow"><title>c#</title><base href=../../ ><link href="https://fonts.googleapis.com/css?family=Open+Sans" rel=stylesheet><link rel=stylesheet type=text/css href=css/style.css><link rel=alternate type=application/rss+xml title="The Blog of Zachary Snow" href=feed.rss><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><div class=wrap><nav class="navbar navbar-expand-lg navbar-dark bg-dark"><h1><a class=navbar-brand href=/ >The Blog of Zachary Snow</a></h1><button id=navbar-toggler class=navbar-toggler type=button aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation"><span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=index.html>Home</a><li class=nav-item><a class=nav-link href=about.html>About</a><li class=nav-item><a class=nav-link href=tags.html>Tags</a></ul><div class="social my-2 my-lg-0"><a href=https://twitter.com/smack0007 class=twitter title=Twitter><span class=icon-twitter></span></a> <a href=https://github.com/smack0007 class=github title=Github><span class=icon-github></span></a> <a href=https://paypal.me/smack0007 class=coffee title="Buy me a Coffee"><span class=icon-mug></span></a> <a href=feed.rss class=rss title=RSS><span class=icon-rss></span></a></div></div></nav><main class=container><div class=posts><div class=post><h2><a href=blog/2010/implementing-basic-dependency-injection-using-services-container.html>Implementing basic Dependency Injection using a Service Container</a></h2><div class=meta><span class=date><span class=icon-calendar></span>June 21, 2010</span> <span class=tags><a href=tags/net/index.html><span class="icon icon-price-tags"></span> <span class=tagName>.net</span></a> <a href=tags/csharp/index.html><span class="icon icon-price-tags"></span> <span class=tagName>c#</span></a> <a href=tags/dependency-injection/index.html><span class="icon icon-price-tags"></span> <span class=tagName>dependency-injection</span></a> <a href=tags/design-patterns/index.html><span class="icon icon-price-tags"></span> <span class=tagName>design-patterns</span></a> <a href=tags/service-container/index.html><span class="icon icon-price-tags"></span> <span class=tagName>service-container</span></a></span></div><div class=content><p>By extending your Service Container class, a very basic version of dependency injection can be implemented. We'll implement two forms of dependency injection: constructor and property injection.</p><a class=readMore href=blog/2010/implementing-basic-dependency-injection-using-services-container.html>Read More</a></div></div><div class=post><h2><a href=blog/2010/progress-bars-in-windows-7-taskbars.html>Progress Bar in Windows 7 Taskbars</a></h2><div class=meta><span class=date><span class=icon-calendar></span>June 01, 2010</span> <span class=tags><a href=tags/net/index.html><span class="icon icon-price-tags"></span> <span class=tagName>.net</span></a> <a href=tags/csharp/index.html><span class="icon icon-price-tags"></span> <span class=tagName>c#</span></a> <a href=tags/windows-7/index.html><span class="icon icon-price-tags"></span> <span class=tagName>windows-7</span></a></span></div><div class=content><p>I decided to add progress bar to the Windows 7 Taskbar in my Timer app.<p>I started by downloading and compiling the <a href=http://code.msdn.microsoft.com/WindowsAPICodePack>Windows API Code Pack</a> in Release mode. I then added a reference to the Microsoft.WindowsAPICodePack.dll and Microsoft.WindowsAPICodePack.Shell.dll files to the project. After that add the lines:
<pre><code class="hljs csharp"><span class=hljs-keyword>using</span> Microsoft.WindowsAPICodePack.Taskbar;</code></pre><p>to your using statements. When the clock starts running I create the progress bar in the taskbar with:
<pre><code class="hljs csharp"><span class=hljs-comment>// Initialize progress bar</span>
<span class=hljs-keyword>if</span>(TaskbarManager.IsPlatformSupported)
{
	TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Normal);
	TaskbarManager.Instance.SetProgressValue(<span class=hljs-number>0</span>, (<span class=hljs-built_in>int</span>)<span class=hljs-keyword>this</span>.totalTime.TotalSeconds, <span class=hljs-keyword>this</span>.Handle);
}</code></pre><p>to stop the progress bar:
<pre><code class="hljs csharp"><span class=hljs-comment>// Stop progress bar</span>
<span class=hljs-keyword>if</span>(TaskbarManager.IsPlatformSupported)
	TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);</code></pre><p>and finally to update the progress bar on each tick:
<pre><code class="hljs csharp"><span class=hljs-comment>// Update progress bar</span>
<span class=hljs-keyword>if</span>(TaskbarManager.IsPlatformSupported)
	TaskbarManager.Instance.SetProgressValue((<span class=hljs-built_in>int</span>)<span class=hljs-keyword>this</span>.totalTime.TotalSeconds - (<span class=hljs-built_in>int</span>)<span class=hljs-keyword>this</span>.time.TotalSeconds, (<span class=hljs-built_in>int</span>)<span class=hljs-keyword>this</span>.totalTime.TotalSeconds, <span class=hljs-keyword>this</span>.Handle);</code></pre></div></div><div class=post><h2><a href=blog/2010/drawing-rectangles-with-spritebatch.html>Drawing Rectangles with SpriteBatch</a></h2><div class=meta><span class=date><span class=icon-calendar></span>March 29, 2010</span> <span class=tags><a href=tags/net/index.html><span class="icon icon-price-tags"></span> <span class=tagName>.net</span></a> <a href=tags/csharp/index.html><span class="icon icon-price-tags"></span> <span class=tagName>c#</span></a> <a href=tags/code-snippets/index.html><span class="icon icon-price-tags"></span> <span class=tagName>code-snippets</span></a> <a href=tags/xna/index.html><span class="icon icon-price-tags"></span> <span class=tagName>xna</span></a></span></div><div class=content><p>Just a quick code snippet which adds an extension method for drawing Rectangles to SpriteBatch:
<pre><code class="hljs csharp"><span class=hljs-keyword>public</span> <span class=hljs-keyword>static</span> <span class=hljs-keyword>class</span> <span class=hljs-title>SpriteBatchHelper</span>
{
	<span class=hljs-keyword>static</span> Texture2D pixel;

	<span class=hljs-function><span class=hljs-keyword>private</span> <span class=hljs-keyword>static</span> <span class=hljs-keyword>void</span> <span class=hljs-title>LoadPixel</span>(<span class=hljs-params>GraphicsDevice graphicsDevice</span>)</span>
	{
		<span class=hljs-keyword>if</span>(pixel == <span class=hljs-literal>null</span>)
		{
			pixel = <span class=hljs-keyword>new</span> Texture2D(graphicsDevice, <span class=hljs-number>1</span>, <span class=hljs-number>1</span>);
			pixel.SetData&amp;lt;Color&amp;gt;(<span class=hljs-keyword>new</span> Color[] { Color.White });
		}
	}

	<span class=hljs-function><span class=hljs-keyword>public</span> <span class=hljs-keyword>static</span> <span class=hljs-keyword>void</span> <span class=hljs-title>DrawRectangle</span>(<span class=hljs-params><span class=hljs-keyword>this</span> SpriteBatch spriteBatch, Rectangle rectangle, Color color</span>)</span>
	{
		LoadPixel(spriteBatch.GraphicsDevice);
		spriteBatch.Draw(pixel, rectangle, color);
	}
}</code></pre></div></div><div class=post><h2><a href=blog/2010/csharp-extension-methods-in-your-own-library.html>C# Extension Methods in your own Library</a></h2><div class=meta><span class=date><span class=icon-calendar></span>March 08, 2010</span> <span class=tags><a href=tags/net/index.html><span class="icon icon-price-tags"></span> <span class=tagName>.net</span></a> <a href=tags/csharp/index.html><span class="icon icon-price-tags"></span> <span class=tagName>c#</span></a> <a href=tags/extension-methods/index.html><span class="icon icon-price-tags"></span> <span class=tagName>extension-methods</span></a></span></div><div class=content><p>Normally I use extension methods in C# to extend a library that I did not write and therefore I have no control over. There are situations where it makes sense to use extension methods for a library that you yourself are writing.<p>For example, when you have interfaces in your library. You want to keep the number of methods in that interface as low as possible so that classes implementing the interface don't have to do a lot of heavy lifting. This means cutting out methods in an interface that are for the most part just syntactic sugar for another method in the interface.
<pre><code class="hljs csharp"><span class=hljs-keyword>public</span> <span class=hljs-keyword>interface</span> <span class=hljs-title>IServiceContainer</span>
{
    <span class=hljs-function><span class=hljs-keyword>void</span> <span class=hljs-title>AddService</span>(<span class=hljs-params>Type type, Object provider</span>)</span>;
    <span class=hljs-function><span class=hljs-built_in>object</span> <span class=hljs-title>GetService</span>(<span class=hljs-params>Type type</span>)</span>;
}

<span class=hljs-keyword>public</span> <span class=hljs-keyword>static</span> <span class=hljs-keyword>class</span> <span class=hljs-title>IServiceContainerExtensions</span>
{
    <span class=hljs-keyword>public</span> <span class=hljs-keyword>static</span> <span class=hljs-keyword>void</span> AddService&amp;lt;T&amp;gt;(<span class=hljs-keyword>this</span> IServiceContainer services, <span class=hljs-built_in>object</span> provider)
    {
        services.AddService(<span class=hljs-keyword>typeof</span>(T), provider);
    }

    <span class=hljs-keyword>public</span> <span class=hljs-keyword>static</span> T GetService&amp;lt;T&amp;gt;(<span class=hljs-keyword>this</span> IServiceContainer services) <span class=hljs-keyword>where</span> T : <span class=hljs-keyword>class</span>
    {
        <span class=hljs-keyword>return</span> services.GetService(<span class=hljs-keyword>typeof</span>(T)) <span class=hljs-keyword>as</span> T;
    }

    <span class=hljs-keyword>public</span> <span class=hljs-keyword>static</span> T GetRequiredService&amp;lt;T&amp;gt;(<span class=hljs-keyword>this</span> IServiceContainer services) <span class=hljs-keyword>where</span> T : <span class=hljs-keyword>class</span>
    {
        T service = services.GetService(<span class=hljs-keyword>typeof</span>(T)) <span class=hljs-keyword>as</span> T;

        <span class=hljs-keyword>if</span>(service == <span class=hljs-literal>null</span>)
            <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> ServiceNotFoundException(<span class=hljs-keyword>typeof</span>(T));

        <span class=hljs-keyword>return</span> service;
    }
}</code></pre><p>All of the methods in IServiceContainerExtensions are just helper methods for method in IServiceContainer. By making them extension methods in our own library though, we've made the barrier to entry lower. Other people can implement the interface and in a sense "inherit" the helper methods as well.</div></div></div><div class=clear></div><nav aria-label="Page navigation"><ul class="pagination justify-content-center"><li class="page-item disabled"><a class="page-link older" href=# tabindex=-1>Older</a><li class=page-item><a href=tags/csharp/5.html class="page-link newer">Newer</a></ul></nav></main><footer class="p-13 p-md-5 mt-5 text-center text-muted bg-light"><div class=container><ul class=links><li><a href=https://twitter.com/smack0007 class=twitter title=Twitter>Twitter</a><li><a href=https://github.com/smack0007 class=github title=Github>GitHub</a><li><a href=https://paypal.me/smack0007 class=coffee title="Buy me a Coffee">Buy me a Coffee</a><li><a href=feed.rss class=rss title=RSS>RSS</a></ul><p class=mb-0>The Blog of Zachary Snow</div></footer></div><script>document.getElementById("navbar-toggler").onclick=function(){document.getElementById("navbarSupportedContent").classList.toggle("collapse")}</script>